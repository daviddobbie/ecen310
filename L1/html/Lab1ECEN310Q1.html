
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Lab1ECEN310Q1</title><meta name="generator" content="MATLAB 9.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-05-03"><meta name="DC.source" content="Lab1ECEN310Q1.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">David Dobbie : 300340161</a></li><li><a href="#2">Q1:</a></li><li><a href="#3">1b, 1c</a></li><li><a href="#8">1e-g</a></li></ul></div><h2 id="1">David Dobbie : 300340161</h2><p>ECEN 310 / ENGR 440 Communications Engineering Lab 1 - Bit Error Rate</p><pre class="codeinput">clear <span class="string">all</span>; close <span class="string">all</span>; clc;
</pre><h2 id="2">Q1:</h2><pre class="codeinput">set(0, <span class="string">'defaulttextInterpreter'</span>,<span class="string">'latex'</span>)

N = 1e3;

s = zeros(N,1);
n = zeros(N,1);
r = zeros(N,1);
sest = zeros(N,1);

Es = 1;
rng(6) <span class="comment">% sets generator seed</span>

SNRdB_axis = 0:5:15;

<span class="comment">% init MPSK</span>
</pre><h2 id="3">1b, 1c</h2><p>Here there are several plotted constellations for BPSK, QPSK, 8PSK, and 16PSK respectively. We see that as there are more points on the constellation, there is less distance between each symbol. This introduces a potential for symbol error.</p><p>We see that the higher the SNR, the more closely packed the received symbols are to their target decision points. As SNR is reduced, the distribution becomes wider and causes more potential for potential conflict iwht other decision points.</p><p>Constellation plots contain <img src="Lab1ECEN310Q1_eq04224470278587628582.png" alt="$N = 1\times10^{3}$"> data points.</p><pre class="codeinput">M_vect = [2 4 8 16];
<span class="keyword">for</span> M_indx = 1:length(M_vect)
</pre><pre class="codeinput">    M = M_vect(M_indx);
    constel = exp((j * 2* pi * (0:M-1))/ (M));
</pre><pre class="codeinput">    figure(M_indx)
    str = sprintf(<span class="string">"This is a constellation plot for a %d PSK system"</span>, M);
    disp(str)

    <span class="keyword">for</span> SNRdBindx = 1:length(SNRdB_axis);
        SNRdB = SNRdB_axis(SNRdBindx);
        No = Es/db2pow(SNRdB);

        s = randsrc(N,1,constel); <span class="comment">% get rnd symbols, tx</span>
        n = sqrt(No/2)*complex(randn(N,1),randn(N,1)); <span class="comment">% noise samples</span>
        r = s + n; <span class="comment">% rx</span>

        <span class="keyword">for</span> indx = 1:N
            <span class="comment">%returns decision point closest to the received message</span>
            [dmin, const_indx] = min(abs(r(indx) - constel));
            sest(indx) = constel(const_indx);
        <span class="keyword">end</span>

        subplot(2,2,SNRdBindx)

        hold <span class="string">on</span>
        plot(real(r)', imag(r)', <span class="string">'b.'</span>)
        plot(real(constel)', imag(constel)', <span class="string">'r+'</span>, <span class="string">'linewidth'</span>, 2, <span class="string">'markersize'</span> , 8)
        hold <span class="string">off</span>

        ax = gca;
        ax.XAxisLocation = <span class="string">'origin'</span>;
        ax.YAxisLocation = <span class="string">'origin'</span>;
        axis([-2 2 -2 2])
        grid <span class="string">on</span>

        xlabel(<span class="string">'$ \psi_1 (t)$'</span>)
        ylabel(<span class="string">'$ \psi_2 (t)$'</span>)

        title([<span class="string">'$SNR_{dB}$ = '</span> num2str(SNRdB) <span class="string">'dB'</span>])
    <span class="keyword">end</span>
</pre><pre class="codeoutput">This is a constellation plot for a 2 PSK system
</pre><img vspace="5" hspace="5" src="Lab1ECEN310Q1_01.png" alt=""> <pre class="codeoutput">This is a constellation plot for a 4 PSK system
</pre><img vspace="5" hspace="5" src="Lab1ECEN310Q1_02.png" alt=""> <pre class="codeoutput">This is a constellation plot for a 8 PSK system
</pre><img vspace="5" hspace="5" src="Lab1ECEN310Q1_03.png" alt=""> <pre class="codeoutput">This is a constellation plot for a 16 PSK system
</pre><img vspace="5" hspace="5" src="Lab1ECEN310Q1_04.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="8">1e-g</h2><p>Here are the comparisons of the Monte Carlo simulated symbol error rates and the theoretical expressions given. The PSK theoretical expressions given make the smallest distance assumption on the bit error. We see that The difference that becomes apparent. This makes sense as more symbols means that there is less space to place them - reducing the energy difference that may prevent errors. The theorertical lines should act as upper bounds but this is not the case.  This may be due to the approximation of the phase error that comes into effect.</p><pre class="codeinput">SNRdBAxis = -4:2:8;
MAxis = [2 4 8 16];

SERresults = zeros(length(SNRdBAxis), length(MAxis));

Ns = 1e4;

<span class="comment">% loop through and test different M-ary schemes</span>
<span class="keyword">for</span> p = 1:length(SNRdBAxis)
    <span class="keyword">for</span> q = 1:length(MAxis)
        SNRdB_val = SNRdBAxis(p);
        M_val = MAxis(q);
        SERresults(p,q) = getSER(M_val, Ns, SNRdB_val);
    <span class="keyword">end</span>
<span class="keyword">end</span>


SNRdBAxis_theo = -4:0.25:8;
SER_theo = zeros(length(SNRdBAxis_theo), length(MAxis));

<span class="comment">% loop through and test different theoretical M-ary schemes</span>
<span class="keyword">for</span> p = 1:length(SNRdBAxis_theo)
    <span class="keyword">for</span> q = 1:length(MAxis)
        SNRlin_val = db2pow(SNRdBAxis_theo(p));
        M_val = MAxis(q);
        argu = sqrt( 2 * SNRlin_val * log2(M_val) )*sin(pi/M_val);
        SER_theo(p,q) = 2 * qfunc(argu);
    <span class="keyword">end</span>
<span class="keyword">end</span>


<span class="comment">% plot SER results</span>

figure(5)
hold <span class="string">on</span>
grid <span class="string">on</span>
ax = gca;
plot(SNRdBAxis ,SERresults,<span class="string">'linewidth'</span>, 1.5)
ax.ColorOrderIndex = 1;
plot(SNRdBAxis_theo' ,SER_theo(:,1),<span class="string">'--'</span>,<span class="string">'linewidth'</span>, 2.5)
plot(SNRdBAxis_theo' ,SER_theo(:,2),<span class="string">'--'</span>,<span class="string">'linewidth'</span>, 2)
plot(SNRdBAxis_theo' ,SER_theo(:,3),<span class="string">'--'</span>,<span class="string">'linewidth'</span>, 2)
plot(SNRdBAxis_theo' ,SER_theo(:,4),<span class="string">'--'</span>,<span class="string">'linewidth'</span>, 2)

set(ax,<span class="string">'yscale'</span>,<span class="string">'log'</span>)
hold <span class="string">off</span>

xlabel(<span class="string">"$ SNR_{dB} $"</span>)
ylabel(<span class="string">"Symbol Error Rate (SER)"</span>)
title(<span class="string">"Comparison of Different MPSK Methodologies"</span>)

lgnd = legend(<span class="string">'M = 2 Sim.'</span>,<span class="string">'M = 4 Sim.'</span>,<span class="string">'M = 8 Sim.'</span>,<span class="string">'M = 16 Sim.'</span>, <span class="keyword">...</span>
    <span class="string">'M = 2 Theo.'</span>,<span class="string">'M = 4 Theo.'</span>,<span class="string">'M = 8 Theo.'</span>,<span class="string">'M = 16 Theo.'</span>);
lgnd.Location = <span class="string">'southwest'</span>;
set(lgnd,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>)


<span class="comment">% get SER function</span>
<span class="comment">% Inputs: M - number of decision points; Ns - number of data points</span>
<span class="comment">% simulated; SNRdB - SNRdB being tested</span>
<span class="comment">% Outputs: SER</span>

<span class="keyword">function</span> SER = getSER(M, Ns, SNRdB);
    constel = exp((j * 2* pi * (0:M-1))/ (M));
    Es = 1;

    No = Es/db2pow(SNRdB);

    s = randsrc(Ns,1,constel); <span class="comment">% get rnd symbols, tx</span>
    n = sqrt(No/2)*complex(randn(Ns,1),randn(Ns,1)); <span class="comment">% noise samples</span>
    r = s + n; <span class="comment">% rx</span>
    sest = zeros(Ns,1);

    <span class="keyword">for</span> indx = 1:Ns
        <span class="comment">%returns decision point closest to the received message</span>
        [dmin, const_indx] = min(abs(r(indx) - constel));
        sest(indx) = constel(const_indx);
    <span class="keyword">end</span>
    SER = (nnz(s-sest)/Ns);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="Lab1ECEN310Q1_05.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% David Dobbie : 300340161
% ECEN 310 / ENGR 440 Communications Engineering
% Lab 1 - Bit Error Rate

clear all; close all; clc;

%% Q1:

set(0, 'defaulttextInterpreter','latex')

N = 1e3;

s = zeros(N,1);
n = zeros(N,1);
r = zeros(N,1);
sest = zeros(N,1);

Es = 1;
rng(6) % sets generator seed

SNRdB_axis = 0:5:15;

% init MPSK

%% 1b, 1c
% Here there are several plotted constellations for BPSK, QPSK, 8PSK, and
% 16PSK respectively. We see that as there are more points on the
% constellation, there is less distance between each symbol. This introduces
% a potential for symbol error.
%
% We see that the higher the SNR, the more closely packed the received
% symbols are to their target decision points. As SNR is reduced, the
% distribution becomes wider and causes more potential for potential
% conflict iwht other decision points.


     %%
      % Constellation plots contain $N = 1\times10^{3}$ data points.
M_vect = [2 4 8 16];
for M_indx = 1:length(M_vect)
    M = M_vect(M_indx);
    constel = exp((j * 2* pi * (0:M-1))/ (M));    
    
    %%
    
    figure(M_indx)
    str = sprintf("This is a constellation plot for a %d PSK system", M);
    disp(str)  
    
    for SNRdBindx = 1:length(SNRdB_axis);
        SNRdB = SNRdB_axis(SNRdBindx);
        No = Es/db2pow(SNRdB);

        s = randsrc(N,1,constel); % get rnd symbols, tx
        n = sqrt(No/2)*complex(randn(N,1),randn(N,1)); % noise samples
        r = s + n; % rx

        for indx = 1:N
            %returns decision point closest to the received message
            [dmin, const_indx] = min(abs(r(indx) - constel)); 
            sest(indx) = constel(const_indx);
        end
        
        subplot(2,2,SNRdBindx)

        hold on
        plot(real(r)', imag(r)', 'b.')
        plot(real(constel)', imag(constel)', 'r+', 'linewidth', 2, 'markersize' , 8)
        hold off

        ax = gca;
        ax.XAxisLocation = 'origin';
        ax.YAxisLocation = 'origin';
        axis([-2 2 -2 2])
        grid on

        xlabel('$ \psi_1 (t)$')
        ylabel('$ \psi_2 (t)$')

        title(['$SNR_{dB}$ = ' num2str(SNRdB) 'dB'])
    end
    
end


%% 1e-g
% Here are the comparisons of the Monte Carlo simulated symbol error rates
% and the theoretical expressions given. The PSK theoretical expressions
% given make the smallest distance assumption on the bit error. We see that
% The difference that becomes apparent. This makes sense as more symbols
% means that there is less space to place them - reducing the energy
% difference that may prevent errors. The theorertical lines should act as
% upper bounds but this is not the case.  This may be due to the
% approximation of the phase error that comes into effect.


SNRdBAxis = -4:2:8;
MAxis = [2 4 8 16];

SERresults = zeros(length(SNRdBAxis), length(MAxis));

Ns = 1e4;

% loop through and test different M-ary schemes
for p = 1:length(SNRdBAxis)
    for q = 1:length(MAxis)
        SNRdB_val = SNRdBAxis(p);
        M_val = MAxis(q);
        SERresults(p,q) = getSER(M_val, Ns, SNRdB_val);
    end
end


SNRdBAxis_theo = -4:0.25:8;
SER_theo = zeros(length(SNRdBAxis_theo), length(MAxis));

% loop through and test different theoretical M-ary schemes
for p = 1:length(SNRdBAxis_theo)
    for q = 1:length(MAxis)
        SNRlin_val = db2pow(SNRdBAxis_theo(p));
        M_val = MAxis(q);
        argu = sqrt( 2 * SNRlin_val * log2(M_val) )*sin(pi/M_val);
        SER_theo(p,q) = 2 * qfunc(argu);
    end
end


% plot SER results

figure(5)
hold on
grid on
ax = gca;
plot(SNRdBAxis ,SERresults,'linewidth', 1.5)
ax.ColorOrderIndex = 1;
plot(SNRdBAxis_theo' ,SER_theo(:,1),'REPLACE_WITH_DASH_DASH','linewidth', 2.5)
plot(SNRdBAxis_theo' ,SER_theo(:,2),'REPLACE_WITH_DASH_DASH','linewidth', 2)
plot(SNRdBAxis_theo' ,SER_theo(:,3),'REPLACE_WITH_DASH_DASH','linewidth', 2)
plot(SNRdBAxis_theo' ,SER_theo(:,4),'REPLACE_WITH_DASH_DASH','linewidth', 2)

set(ax,'yscale','log')
hold off

xlabel("$ SNR_{dB} $")
ylabel("Symbol Error Rate (SER)")
title("Comparison of Different MPSK Methodologies")

lgnd = legend('M = 2 Sim.','M = 4 Sim.','M = 8 Sim.','M = 16 Sim.', ...
    'M = 2 Theo.','M = 4 Theo.','M = 8 Theo.','M = 16 Theo.');
lgnd.Location = 'southwest';
set(lgnd,'Interpreter','latex')


% get SER function
% Inputs: M - number of decision points; Ns - number of data points
% simulated; SNRdB - SNRdB being tested
% Outputs: SER

function SER = getSER(M, Ns, SNRdB);
    constel = exp((j * 2* pi * (0:M-1))/ (M));
    Es = 1;
    
    No = Es/db2pow(SNRdB);

    s = randsrc(Ns,1,constel); % get rnd symbols, tx
    n = sqrt(No/2)*complex(randn(Ns,1),randn(Ns,1)); % noise samples
    r = s + n; % rx
    sest = zeros(Ns,1);

    for indx = 1:Ns
        %returns decision point closest to the received message
        [dmin, const_indx] = min(abs(r(indx) - constel)); 
        sest(indx) = constel(const_indx);
    end
    SER = (nnz(s-sest)/Ns);
end






##### SOURCE END #####
--></body></html>